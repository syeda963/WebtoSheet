<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>Project</title>
</head>
<body>
    <div class="main_container">
    <h1 style="text-align: center;color: #000;">Add User's</h1>

    <section class="input_container">
        <form id="form">
            <div class="input_wrap">
                <label for="employee">Section:</label>
                <select type="select" id="selectSection" name="section" for="employee" form="form">
                    <option value="">Select</option>
                    <option value="Mysore">Mysore</option>
                    <option value="Hassan">Hassan</option>
                    <option value="Holenarsipur">Holenarsipur</option>
                    <option value="Kabakaputtur">Kabakaputtur</option>
                    <option value="Arsikere">Arsikere</option>
                    <option value="Birur">Birur</option>
                    <option value="Shivamogga">Shivamogga</option>
                    <option value="Chikjajur">Chikjajur</option>
                    <option value="Chitradurga">Chitradurga</option>
                    <option value="Harihar">Harihar</option>
                </select>
            </div>
            <div class="input_wrap">
                <label for="staffName">Staff Name:</label>
                <input type="text" id="staffName" name="staffname" required><br><br>
            </div>
            <div class="input_wrap">
                <label for="CUG">CUG:</label>
                <input type="text" id="CUG" name="cug" required><br><br>
            </div>
            <div class="input_wrap">
                <label for="Other">Other:</label>
                <input type="text" id="Other" name="other" required><br><br>
            </div>
            <div class="input_wrap">
                <label for="movement">Movement:</label>
                <input type="text" id="movement" name="movement" required><br><br>
            </div>

            <div style="display: flex;">
                <button type="submit">Submit & Refresh</button>
            </div>
        </form>
    </section>
    <button id="goNext">Login and View User Details</button>

    <div class="form-popup" id="formPopup">
        <form class="form-container" id="popupFormValue">
          <h2>Login</h2>
      
          <input type="text" placeholder="Enter Email" id="email" name="email" required>
      
          <input type="password" placeholder="Enter Password" id="psw" name="psw" required>
            
          <div style="display: flex; gap: 24px">
            <button type="submit" class="btn">Login</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
          </div>
        </form>
    </div>
    </div>
</body>

<script>
let form = document.getElementById("form");
let popupFormValue = document.getElementById("popupFormValue");

function checkProperties(obj) {
    for (var key in obj) {
        if (obj[key] !== null && obj[key] != "")
            return true;
    }
    return false;
}

form.addEventListener("submit", (e) => {
e.preventDefault();

const formInfo = new FormData(form);
const formValue = JSON.stringify(form)
const formInfoObj = Object.fromEntries(formInfo.entries());

    if(formInfoObj?.section !== '') {
        console.log(formInfo,'formInfo');
        fetch('https://script.google.com/macros/s/AKfycbzN-RRdv2Ckpf9s_Rx5gl19AWpHP3TI8fNIO2wfKUR9GN8fsHh8HGfsyoZNyP3tZ6FM8g/exec',
        {
            method: 'POST',
            mode: 'no-cors',
            body: formInfo,
        })
        .then(res => {
            if(res.status==302 || res.status==200) {
                alert('User Added Successfully')
                console.log(res,'data')
            }
        })
        .catch(err=> alert(err))
        this.form.reset();
    } else {
        alert('please provide section')
    }
});

function closeForm() {
    document.getElementById("formPopup").style.display = "none"
}

popupFormValue.addEventListener("submit", (e) => {
e.preventDefault();
    const formInfo = new FormData(popupFormValue);
    const formInfoObj = Object.fromEntries(formInfo.entries());
    console.log(formInfoObj,'eeeee');

    if(formInfoObj.email === "swrRailway@Email.com" && formInfoObj.psw == "PersonalRailway")
        location.href = "./page2.html";

    else
        alert('Please provide valid email id and password')
})

document.getElementById("goNext").onclick = function () {
    document.getElementById("formPopup").style.display = "block";
};
</script>
</html>